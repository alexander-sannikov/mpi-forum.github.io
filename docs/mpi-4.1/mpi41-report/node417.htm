<!DOCTYPE html>
<html lang=en>
<head>
<!-- This file was generated by tohtml from chap-tools/mpit-rendered -->
<!-- with the command
tohtml -default -numbers -dosnl -htables -quietlatex -allgif -endpage mpi4-forum-tail.htm -Wnoredef --mpidoc --latexpgm pdflatex --indexfile mpi41-report-html.idx -basedef mpi4defs.txt -o mpi41-report.tex mpi-report.tex 
-->
<title>Initialization and Finalization</title>
</head>
<body style="background-color:#FFFFFF">
<hr><h2><span id="Node417">16.3.4. Initialization and Finalization</span></h2>
<a href="node416.htm#Node416"><img width=16 height=16 src="previous.gif" alt="Previous"></a><a href="node413.htm#Node413"><img width=16 height=16 src="up.gif" alt="Up"></a><a href="node418.htm#Node418"><img width=16 height=16 src="next.gif" alt="Next"></a><br>
<b>Up: </b><a href="node413.htm#Node413"> The <font face="sans-serif"> MPI</font> Tool Information Interface</a>
<b>Next: </b><a href="node418.htm#Node418"> Datatype System</a>
<b>Previous: </b><a href="node416.htm#Node416"> Convention for Returning Strings</a>
<p>
  
<P> 
The <font face="sans-serif"> MPI</font> tool information interface requires a separate set of  
initialization and finalization routines.  
<P> 
<TABLE><TR><TD COLSPAN=2>MPI_T_INIT_THREAD(<span style="white-space:nowrap">required</span>, <span style="white-space:nowrap">provided</span>)</TD></TR>  
<TR><TD> IN required</TD><TD>desired level of thread support (integer)</TD></TR>  
<TR><TD> OUT provided</TD><TD>provided level of thread support (integer)</TD></TR>  
</TABLE>  
  <b> C binding</b><br>  <tt> int MPI_T_init_thread(int required, int *provided) <br></tt>  
<P> 
All programs or tools that use the <font face="sans-serif"> MPI</font> tool information interface must  
initialize the <font face="sans-serif"> MPI</font> tool information interface in the processes that will  
use the interface before calling any other of its routines.  A user can  
initialize the <font face="sans-serif"> MPI</font> tool information interface by calling  
<font face="sans-serif"> MPI_T_INIT_THREAD</font>, which can be called multiple times.  In  
addition, this routine initializes the thread environment for all routines  
in the <font face="sans-serif"> MPI</font> tool information interface.  Calling this routine when the  
<font face="sans-serif"> MPI</font> tool information interface is already initialized has no effect  
beyond increasing the reference count of how often the interface has been  
initialized.  The argument <font face="sans-serif"> required</font> is used to specify the desired  
level of thread support.  The possible values and their semantics are  
identical to the ones that can be used with <font face="sans-serif"> MPI_INIT_THREAD</font>  
listed in Section <a href="node281.htm#Node281"><font face="sans-serif"> MPI</font> and Threads</a>.  The call returns in  
<font face="sans-serif"> provided</font> information about the actual level of thread support that  
will be provided by the <font face="sans-serif"> MPI</font> implementation for calls to <font face="sans-serif"> MPI</font> tool  
information interface routines.  It can be one of the four values listed in  
Section <a href="node281.htm#Node281"><font face="sans-serif"> MPI</font> and Threads</a>.  
<P> 
The <font face="sans-serif"> MPI</font> specification does not require all <font face="sans-serif"> MPI</font> processes to exist  
before <font face="sans-serif"> MPI</font> is initialized.  If the <font face="sans-serif"> MPI</font> tool information  
interface is used before initialization of <font face="sans-serif"> MPI</font>, the user is  
responsible for ensuring that the <font face="sans-serif"> MPI</font> tool information interface is  
initialized on all processes it is used in.  Processes created by the <font face="sans-serif"> MPI</font>  
implementation during initialization inherit the status of the <font face="sans-serif"> MPI</font>  
tool information interface (whether it is initialized or not as well as all  
active sessions and handles) from the process from which they are created.  
<P> 
Processes created at runtime as a result of calls to <font face="sans-serif"> MPI</font>'s dynamic  
process management require their own initialization before they can use the  
<font face="sans-serif"> MPI</font> tool information interface.  
<P> 
 
<br> 
<em> Advice to users.</em>  
<P> 
If <font face="sans-serif"> MPI_T_INIT_THREAD</font> is called before  
<font face="sans-serif"> MPI_INIT_THREAD</font>, the requested and provided thread level for  
<font face="sans-serif"> MPI_T_INIT_THREAD</font> may influence the behavior and return value  
of <font face="sans-serif"> MPI_INIT_THREAD</font>.  The same is true for the reverse order.  
Likewise, when using the Sessions Model (Section <a href="node271.htm#Node271">The Sessions Model</a>), the requested  
and provided thread level for <font face="sans-serif"> MPI_T_INIT_THREAD</font> may influence  
the behavior and return values of <font face="sans-serif"> MPI_SESSION_INIT</font> (see Section <a href="node271.htm#Node271">The Sessions Model</a>), with the  
same being true for the reverse order.  
 (<em> End of advice to users.</em>) <br> 
 
<br> 
<em> Advice  
        to implementors.</em>  
<P> 
<font face="sans-serif"> MPI</font> implementations should strive to make as many control or performance  
variables available before <font face="sans-serif"> MPI</font> initialization (instead of adding them  
during initialization) to allow tools the most flexibility.  In  
particular, control variables should be available before  
<font face="sans-serif"> MPI</font> initialization if their value cannot be changed after  
<font face="sans-serif"> MPI</font> initialization.  
 (<em> End of advice to implementors.</em>) <br> 
<P><img width=189 height=23 src="img445.gif" alt="Image file"><P>
  <tt> int MPI_T_finalize(void) <br></tt>  
<P> 
This routine finalizes the use of the <font face="sans-serif"> MPI</font> tool information interface and  
may be called as often as the corresponding <font face="sans-serif"> MPI_T_INIT_THREAD</font>  
routine up to the current point of execution.  Calling it more times  
returns a corresponding return code.  As long as the number of calls to  
<font face="sans-serif"> MPI_T_FINALIZE</font> is smaller than the number of calls to  
<font face="sans-serif"> MPI_T_INIT_THREAD</font> up to the current point of execution, the  
<font face="sans-serif"> MPI</font> tool information interface remains initialized and calls to its  
routines are permissible.  Further, additional calls to  
<font face="sans-serif"> MPI_T_INIT_THREAD</font> after one or more calls to  
<font face="sans-serif"> MPI_T_FINALIZE</font> are permissible.  
<P> 
Once <font face="sans-serif"> MPI_T_FINALIZE</font> is called the same number of times as the  
routine <font face="sans-serif"> MPI_T_INIT_THREAD</font> up to the current point of  
execution, the <font face="sans-serif"> MPI</font> tool information interface is no longer initialized.  
The user can reinitialize the interface by a subsequent call  
to <font face="sans-serif"> MPI_T_INIT_THREAD</font>.  
<P> 
At the end of the program execution, unless <font face="sans-serif"> MPI_ABORT</font> is called,  
an application must have called <font face="sans-serif"> MPI_T_INIT_THREAD</font> and  
<font face="sans-serif"> MPI_T_FINALIZE</font> an equal number of times.  
<P> 

<P>
<hr>
<a href="node416.htm#Node416"><img width=16 height=16 src="previous.gif" alt="Previous"></a><a href="node413.htm#Node413"><img width=16 height=16 src="up.gif" alt="Up"></a><a href="node418.htm#Node418"><img width=16 height=16 src="next.gif" alt="Next"></a><br>
<b>Up: </b><a href="node413.htm#Node413"> The <font face="sans-serif"> MPI</font> Tool Information Interface</a>
<b>Next: </b><a href="node418.htm#Node418"> Datatype System</a>
<b>Previous: </b><a href="node416.htm#Node416"> Convention for Returning Strings</a>
<p>
<HR>
Return to <A HREF="node601.htm">MPI-4.1 Standard Index</A><BR>
Return to <A HREF="http://www.mpi-forum.org/index.html">MPI Forum Home Page</A><BR>
<HR>
<FONT SIZE=-1>(Unofficial) MPI-4.1 of November 2, 2023<BR>
HTML Generated on November 19, 2023
</FONT>
</body>
</html>
