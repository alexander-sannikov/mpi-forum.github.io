<!DOCTYPE html>
<html lang=en>
<head>
<!-- This file was generated by tohtml from chap-binding/binding-2-rendered -->
<!-- with the command
tohtml -default -numbers -dosnl -htables -quietlatex -allgif -endpage mpi4-forum-tail.htm -Wnoredef --mpidoc --latexpgm pdflatex --indexfile mpi41-report-html.idx -basedef mpi4defs.txt -o mpi41-report.tex mpi-report.tex 
-->
<title>Attributes</title>
</head>
<body style="background-color:#FFFFFF">
<hr><h2><span id="Node514">20.3.7. Attributes</span></h2>
<a href="node509.htm#Node513"><img width=16 height=16 src="previous.gif" alt="Previous"></a><a href="node500.htm#Node500"><img width=16 height=16 src="up.gif" alt="Up"></a><a href="node515.htm#Node515"><img width=16 height=16 src="next.gif" alt="Next"></a><br>
<b>Up: </b><a href="node500.htm#Node500"> Language Interoperability</a>
<b>Next: </b><a href="node515.htm#Node515"> Extra-State</a>
<b>Previous: </b><a href="node509.htm#Node513"> Reduce Operations</a>
<p>
  
  
<P> 
Attribute keys can be allocated in one language and freed in another.  
Similarly, attribute values can be set in one language and accessed in  
another.  To achieve this, attribute keys will be allocated in an integer  
range that is valid all languages.  The same holds true for system-defined  
attribute values (such as <font face="sans-serif"> MPI_TAG_UB</font>,  
<font face="sans-serif"> MPI_WTIME_IS_GLOBAL</font>, etc.).  
<P> 
Attribute keys declared in one language are associated with copy and  
delete functions in that language  
(the functions provided by the <font face="sans-serif"> MPI_</font><font face="sans-serif"> XXX</font>_CREATE_KEYVAL</font> call).  
When a  
communicator is duplicated, for each attribute, the corresponding copy  
function is called, using the right calling  
convention for the language of that function; and similarly, for the  
delete callback function.  
<P> 
 
<br> 
<em> Advice  
        to implementors.</em>  
<P> 
This requires that attributes be tagged either as  
``C'' or ``Fortran''  
 and that the language tag be checked in order to use  
the right calling convention for the callback function.  
 (<em> End of advice to implementors.</em>) <br> 
The attribute manipulation functions described in  
Section <a href="node204.htm#Node204">Caching</a>  
defines  
attributes arguments to be of type <tt>void*</tt> in C, and of type  
<tt> INTEGER</tt>, in Fortran.  On some systems,  
<tt> INTEGER</tt>s will have 32 bits, while  
C pointers will have  
64 bits.  This is a problem if communicator attributes are used to  
move information from a Fortran caller to a  
C callee, or  
vice-versa.  
<P> 
<font face="sans-serif"> MPI</font> behaves as if it stores,  
internally, address sized attributes.  If Fortran <tt> INTEGER</tt>s  
are smaller, then the (deprecated) Fortran function <font face="sans-serif"> MPI_ATTR_GET</font> will  
return the least significant part of the attribute word; the (deprecated) Fortran  
function <font face="sans-serif"> MPI_ATTR_PUT</font> will set the least significant part  
of the attribute word, which will be sign extended to the entire word.  
(These two functions may be invoked explicitly by user code, or  
implicitly, by attribute copying callback functions.)  
<P> 
As for addresses, new functions are provided that manipulate  
Fortran address sized attributes, and have the same functionality as the  
old  
functions in C.  These functions are described in  
Section <a href="node204.htm#Node204">Caching</a>.  
Users are encouraged to use these new functions.  
<P> 
<font face="sans-serif"> MPI</font> supports two types of attributes:  address-valued (pointer) attributes,  
and integer-valued attributes.  C  
attribute functions put and get address-valued  
attributes.  Fortran attribute functions put and get integer-valued  
attributes.  When an integer-valued attribute is accessed from  
C,  
then  
<font face="sans-serif"> MPI_</font><font face="sans-serif"> XXX</font>_get_attr</font>  
will return the address of (a pointer to) the integer-valued  
attribute, which is a pointer to  
  <font face="sans-serif"> MPI_Aint</font> if the attribute was stored with Fortran  
  <font face="sans-serif"> MPI_</font><font face="sans-serif"> XXX</font>_SET_ATTR</font>, and a pointer to <tt> int</tt> if it was  
  stored with the deprecated Fortran <font face="sans-serif"> MPI_ATTR_PUT</font>.  When an  
address-valued attribute is accessed from  
Fortran, then <font face="sans-serif"> MPI_</font><font face="sans-serif"> XXX</font>_GET_ATTR</font>  
will convert the address into an integer and  
return the result of this conversion.  This conversion is lossless if new  
style  
attribute functions are used, and an integer of kind  
<font face="sans-serif"> MPI_ADDRESS_KIND</font>  
is returned.  The conversion may cause truncation if  
deprecated  
attribute functions are used.  
In C, the deprecated routines  
  <font face="sans-serif"> MPI_Attr_put</font> and <font face="sans-serif"> MPI_Attr_get</font> behave identical  
  to <font face="sans-serif"> MPI_Comm_set_attr</font> and <font face="sans-serif"> MPI_Comm_get_attr</font>.  
<P> 
<br><b> Example</b>  
Setting an attribute in C and reading in C or Fortran.  
  
A. Setting an attribute value in C  
<P><img width=729 height=250 src="img491.gif" alt="Image file"><P>
B. Reading the attribute value in C  
<P> 
<P><img width=779 height=275 src="img492.gif" alt="Image file"><P>
C. Reading the attribute value with (deprecated) Fortran <font face="sans-serif"> MPI-1</font> calls  
<P> 
<P><img width=881 height=225 src="img493.gif" alt="Image file"><P>
D. Reading the attribute value with Fortran <font face="sans-serif"> MPI-2</font> calls  
<P> 
<P><img width=881 height=250 src="img494.gif" alt="Image file"><P>
  
<P> 
<br><b> Example</b>  
Setting an attribute in Fortran and reading in C or Fortran.  
  
A. Setting an attribute value with the (deprecated) Fortran <font face="sans-serif"> MPI-1</font> call  
<P> 
<P><img width=729 height=75 src="img495.gif" alt="Image file"><P>
B. Reading the attribute value in C  
<P> 
<P><img width=831 height=150 src="img496.gif" alt="Image file"><P>
C. Reading the attribute value with (deprecated) Fortran <font face="sans-serif"> MPI-1</font> calls  
<P> 
<P><img width=744 height=125 src="img497.gif" alt="Image file"><P>
D. Reading the attribute value with Fortran <font face="sans-serif"> MPI-2</font> calls  
<P> 
<P><img width=806 height=150 src="img498.gif" alt="Image file"><P>
  
<P> 
  
<P> 
<br><b> Example</b>  
Setting an attribute in Fortran and reading in C or Fortran.  
  
A. Setting an attribute value via a Fortran <font face="sans-serif"> MPI-2</font> call  
<P> 
<P><img width=756 height=200 src="img499.gif" alt="Image file"><P>
B. Reading the attribute value in C  
<P> 
<P><img width=844 height=225 src="img500.gif" alt="Image file"><P>
C. Reading the attribute value with (deprecated) Fortran <font face="sans-serif"> MPI-1</font> calls  
<P> 
<P><img width=806 height=200 src="img501.gif" alt="Image file"><P>
D. Reading the attribute value with Fortran <font face="sans-serif"> MPI-2</font> calls  
<P> 
<P><img width=831 height=200 src="img502.gif" alt="Image file"><P>
  
<P> 
The predefined <font face="sans-serif"> MPI</font> attributes can be integer valued or address-valued.  
Predefined integer valued attributes, such as <font face="sans-serif"> MPI_TAG_UB</font>,  
behave as if they  
were put by a call to the  
  deprecated Fortran routine <font face="sans-serif"> MPI_ATTR_PUT</font>,  
i.e.,  
in Fortran,  
<font face="sans-serif"> MPI_COMM_GET_ATTR(MPI_COMM_WORLD, MPI_TAG_UB, val, flag, ierr)</font>  
will return in <font face="sans-serif"> val</font>  
the upper bound for tag value; in C,  
<font face="sans-serif"> MPI_Comm_get_attr(MPI_COMM_WORLD, MPI_TAG_UB, &amp;p, &amp;flag)</font>  
will return in <font face="sans-serif"> p</font>  
a pointer to an int containing the upper bound for tag value.  
<P> 
Address-valued predefined attributes, such as <font face="sans-serif"> MPI_WIN_BASE</font>  
behave as if  
they were put by a C call,  
i.e.,  
in  Fortran,  
<font face="sans-serif"> MPI_WIN_GET_ATTR(win, MPI_WIN_BASE, val, flag, ierror)</font>  
will return in <font face="sans-serif"> val</font> the base address of the window,  
converted to an integer.  In C,  
<font face="sans-serif"> MPI_Win_get_attr(win, MPI_WIN_BASE, &amp;p, &amp;flag)</font>  
will return in <font face="sans-serif"> p</font>  
a pointer to the window base, cast to <tt>(void *)</tt>.  
<P> 
 
<br> 
<em> Rationale.</em>  
<P> 
The design is consistent with the behavior  
specified  
for predefined  
attributes, and ensures that no information is lost when attributes are  
passed from language to language.  
Because the language interoperability for  
  predefined attributes was defined based on <font face="sans-serif"> MPI_ATTR_PUT</font>,  
  this definition is kept for compatibility reasons although the  
  routine itself is now deprecated.  
 (<em> End of rationale.</em>) <br> 
 
<br> 
<em> Advice  
        to implementors.</em>  
<P> 
Implementations should tag attributes either as  
  (1)  
    address attributes, (2) as  
    <tt>INTEGER(KIND=MPI_ADDRESS_KIND)</tt> attributes or (3) as  
    <tt>INTEGER</tt> attributes, according to whether they were set in  
    (1) C (with <font face="sans-serif"> MPI_Attr_put</font> or  
    <font face="sans-serif"> MPI_</font><font face="sans-serif"> XXX</font>_set_attr</font>), (2) in Fortran with  
    <font face="sans-serif"> MPI_</font><font face="sans-serif"> XXX</font>_SET_ATTR</font> or (3) with the deprecated Fortran  
  
    routine <font face="sans-serif"> MPI_ATTR_PUT</font>.  
    Thus, the right choice can be made when the attribute is retrieved.  
 (<em> End of advice to implementors.</em>) <br> 

<P>
<hr>
<a href="node509.htm#Node513"><img width=16 height=16 src="previous.gif" alt="Previous"></a><a href="node500.htm#Node500"><img width=16 height=16 src="up.gif" alt="Up"></a><a href="node515.htm#Node515"><img width=16 height=16 src="next.gif" alt="Next"></a><br>
<b>Up: </b><a href="node500.htm#Node500"> Language Interoperability</a>
<b>Next: </b><a href="node515.htm#Node515"> Extra-State</a>
<b>Previous: </b><a href="node509.htm#Node513"> Reduce Operations</a>
<p>
<HR>
Return to <A HREF="node601.htm">MPI-4.1 Standard Index</A><BR>
Return to <A HREF="http://www.mpi-forum.org/index.html">MPI Forum Home Page</A><BR>
<HR>
<FONT SIZE=-1>(Unofficial) MPI-4.1 of November 2, 2023<BR>
HTML Generated on November 19, 2023
</FONT>
</body>
</html>
